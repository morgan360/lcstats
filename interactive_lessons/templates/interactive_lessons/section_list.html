{% extends "_base.html" %}
{% block title %}{{ topic.name}} - Sections{% endblock %}
{% block content %}

<div class="mb-5">
    <a href="{% url 'select_topic' %}" class="font-medium text-[#667eea] hover:text-[#764ba2]">
        ← Back to Topics
    </a>
</div>

<h2 class="mb-8 text-center text-2xl font-semibold text-mist">{{ topic.name }} - Select a Section</h2>

<div class="w-full overflow-hidden rounded-xl border border-indigo-deep/15 bg-mist shadow-[0_10px_30px_rgba(0,0,0,0.08)]">
    <div class="hidden grid-cols-[2fr_1fr_1fr_1fr] gap-4 bg-[linear-gradient(135deg,#667eea_0%,#764ba2_100%)] px-5 py-4 text-sm font-semibold text-white md:grid">
        <div>Section</div>
        <div class="text-center">Progress</div>
        <div class="text-center">Questions</div>
        <div class="text-center">Start Quiz</div>
    </div>

    {% for item in section_data %}
    <div class="grid grid-cols-1 items-center gap-3 border-b border-indigo-deep/15 px-5 py-5 transition hover:bg-mist/80 last:border-b-0 md:grid-cols-[2fr_1fr_1fr_1fr] md:gap-4">
        <div class="text-lg font-semibold text-midnight md:mb-0 md:border-0 mb-2 border-b border-indigo-deep/15 pb-2">
            {{ item.section.name }}
        </div>

        <div class="text-center">
            <div class="mb-2 h-2 w-full overflow-hidden rounded-full bg-[#e0e0e0]">
                <div class="h-full {% if item.is_completed %}bg-[linear-gradient(90deg,#4CAF50_0%,#45a049_100%)]{% else %}bg-[linear-gradient(90deg,#667eea_0%,#764ba2_100%)]{% endif %}"
                    style="width: {{ item.completion_percentage }}%;"></div>
            </div>
            <span class="inline-block rounded-full px-3 py-1 text-xs font-semibold {% if item.completion_percentage == 0 %}bg-[#f0f0f0] text-[#666]{% elif item.is_completed %}bg-[#e8f5e9] text-[#4caf50]{% else %}bg-[#fff3e0] text-[#f57c00]{% endif %}">
                {{ item.completed_questions }}/{{ item.total_questions }}
            </span>
        </div>

        <div class="text-center text-sm text-[#666]">
            {{ item.total_questions }} question{{ item.total_questions|pluralize }}
        </div>

        <div class="flex justify-center">
            {% if item.total_questions > 0 %}
                <a href="{% url 'section_quiz' topic.slug item.section.slug %}"
                   class="inline-flex w-full max-w-[150px] items-center justify-center rounded-lg px-4 py-2 text-sm font-semibold text-white shadow-[0_12px_24px_rgba(0,0,0,0.18)] transition hover:-translate-y-0.5 hover:shadow-[0_16px_30px_rgba(0,0,0,0.24)] focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-violet-royal {% if item.is_completed %}bg-[linear-gradient(135deg,#4CAF50_0%,#45a049_100%)]{% elif item.completed_questions > 0 %}bg-[linear-gradient(135deg,#f093fb_0%,#f5576c_100%)]{% else %}bg-[linear-gradient(135deg,#667eea_0%,#764ba2_100%)]{% endif %}">
                    {% if item.is_completed %}
                        ✓ Review
                    {% elif item.completed_questions > 0 %}
                        Continue
                    {% else %}
                        Start
                    {% endif %}
                </a>
            {% else %}
                <span class="text-[#999]">No questions</span>
            {% endif %}
        </div>
    </div>
    {% empty %}
    <div class="px-5 py-10 text-center">
        <p class="text-[#999]">No sections available for this topic yet.</p>
    </div>
    {% endfor %}
</div>

{% endblock %}
