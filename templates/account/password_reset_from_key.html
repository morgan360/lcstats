{% extends "_base.html" %}

{% block title %}Set New Password | LCAI Maths{% endblock %}

{% block content %}
<div style="max-width: 500px; margin: 60px auto; padding: 20px;">
    <div style="background: white; border-radius: 12px; padding: 40px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
        {% if token_fail %}
            <div style="text-align: center;">
                <div style="font-size: 4em; margin-bottom: 20px;">‚ö†Ô∏è</div>
                <h1 style="color: #ef5350; font-size: 2em; margin-bottom: 15px;">Invalid Reset Link</h1>
                <p style="color: #666; font-size: 1.1em; margin-bottom: 30px; line-height: 1.6;">
                    This password reset link is invalid or has expired.
                    Please request a new password reset.
                </p>
                <a href="{% url 'account_reset_password' %}"
                   style="display: inline-block; background: linear-gradient(135deg, #004aad 0%, #0066cc 100%); color: white; padding: 14px 40px; font-size: 1.1em; text-decoration: none; border-radius: 6px; font-weight: 600;">
                    Request New Reset Link
                </a>
            </div>
        {% else %}
            <div style="text-align: center; margin-bottom: 30px;">
                <div style="font-size: 3em; margin-bottom: 15px;">üîê</div>
                <h1 style="color: #004aad; font-size: 2em; margin-bottom: 10px;">Set New Password</h1>
                <p style="color: #666; font-size: 1em;">Enter your new password below</p>
            </div>

            {% if messages %}
                {% for message in messages %}
                    <div style="background-color: {% if message.tags == 'error' or message.tags == 'danger' %}#ffebee{% else %}#e8f5e9{% endif %};
                                border: 1px solid {% if message.tags == 'error' or message.tags == 'danger' %}#ef5350{% else %}#66bb6a{% endif %};
                                padding: 12px;
                                border-radius: 6px;
                                margin-bottom: 20px;
                                text-align: center;">
                        {{ message }}
                    </div>
                {% endfor %}
            {% endif %}

            <form method="POST" action="">
                {% csrf_token %}

                {% if form.non_field_errors %}
                    <div style="background-color: #ffebee; border: 1px solid #ef5350; padding: 12px; border-radius: 6px; margin-bottom: 20px;">
                        {{ form.non_field_errors }}
                    </div>
                {% endif %}

                <div style="margin-bottom: 20px;">
                    <label for="{{ form.password1.id_for_label }}" style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">
                        New Password
                    </label>
                    <input type="password"
                           name="{{ form.password1.name }}"
                           id="{{ form.password1.id_for_label }}"
                           placeholder="Enter your new password"
                           required
                           style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 6px; font-size: 1em; box-sizing: border-box; transition: border-color 0.3s;">
                    {% if form.password1.errors %}
                        <div style="color: #ef5350; font-size: 0.9em; margin-top: 5px;">
                            {{ form.password1.errors }}
                        </div>
                    {% endif %}
                    {% if form.password1.help_text %}
                        <div style="color: #999; font-size: 0.85em; margin-top: 5px;">
                            {{ form.password1.help_text|safe }}
                        </div>
                    {% endif %}
                </div>

                <div style="margin-bottom: 25px;">
                    <label for="{{ form.password2.id_for_label }}" style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">
                        Confirm New Password
                    </label>
                    <input type="password"
                           name="{{ form.password2.name }}"
                           id="{{ form.password2.id_for_label }}"
                           placeholder="Re-enter your new password"
                           required
                           style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 6px; font-size: 1em; box-sizing: border-box; transition: border-color 0.3s;">
                    {% if form.password2.errors %}
                        <div style="color: #ef5350; font-size: 0.9em; margin-top: 5px;">
                            {{ form.password2.errors }}
                        </div>
                    {% endif %}
                </div>

                <button type="submit"
                        style="width: 100%; background: linear-gradient(135deg, #00994c 0%, #00cc66 100%); color: white; padding: 14px; font-size: 1.1em; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; transition: transform 0.2s;">
                    Change Password
                </button>
            </form>
        {% endif %}
    </div>
</div>

<style>
    input[type="password"]:focus {
        outline: none;
        border-color: #00994c;
    }

    button[type="submit"]:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 153, 76, 0.3);
    }
</style>
{% endblock %}